<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ¥š EggVaultâ€” Gerenciamento de Ovos</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ¥š</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TELA DE LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="login-overlay" id="login-overlay">
        <div class="login-card">
            <div class="login-header">
                <span class="login-logo">ðŸ¥š</span>
                <h1>EggVault</h1>
                <p>FaÃ§a login para continuar</p>
            </div>
            <form id="form-login">
                <div class="form-group">
                    <label for="login-username"><i class="fas fa-user"></i> UsuÃ¡rio</label>
                    <input type="text" id="login-username" required placeholder="admin" autocomplete="username" autocapitalize="none">
                </div>
                <div class="form-group">
                    <label for="login-password"><i class="fas fa-lock"></i> Senha</label>
                    <div class="password-wrapper">
                        <input type="password" id="login-password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
                        <button type="button" class="btn-toggle-password" onclick="togglePasswordVisibility()">
                            <i class="fas fa-eye" id="password-eye-icon"></i>
                        </button>
                    </div>
                </div>
                <div class="login-error" id="login-error" style="display:none;">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="login-error-text"></span>
                </div>
                <button type="submit" class="btn btn-primary btn-login" id="btn-login">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
            </form>
            <div class="login-footer">
                <small>Primeiro acesso? use <strong>admin</strong> / <strong>admin</strong></small>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL ALTERAR SENHA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal-overlay" id="modal-senha" style="display:none;">
        <div class="modal-card">
            <h3><i class="fas fa-key"></i> Alterar Senha</h3>
            <form id="form-alterar-senha">
                <div class="form-group">
                    <label for="senha-atual">Senha Atual</label>
                    <input type="password" id="senha-atual" required placeholder="Senha atual">
                </div>
                <div class="form-group">
                    <label for="nova-senha">Nova Senha</label>
                    <input type="password" id="nova-senha" required placeholder="MÃ­nimo 4 caracteres" minlength="4">
                </div>
                <div class="form-group">
                    <label for="confirmar-senha">Confirmar Nova Senha</label>
                    <input type="password" id="confirmar-senha" required placeholder="Repita a nova senha">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-icon-text" onclick="hideChangePassword()">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL CONFIRMAR AÃ‡ÃƒO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal-overlay" id="modal-confirm" style="display:none;">
        <div class="modal-card modal-confirm-card">
            <div class="confirm-icon" id="confirm-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 id="confirm-title">Confirmar AÃ§Ã£o</h3>
            <p class="confirm-message" id="confirm-message">Tem certeza?</p>
            <div class="modal-actions">
                <button type="button" class="btn btn-icon-text" id="confirm-cancel-btn">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button type="button" class="btn btn-danger" id="confirm-ok-btn">
                    <i class="fas fa-check"></i> Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL REDEFINIR SENHA (ADMIN) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="modal-overlay" id="modal-reset-senha" style="display:none;">
        <div class="modal-card">
            <h3><i class="fas fa-key"></i> Redefinir Senha</h3>
            <p class="confirm-message" id="reset-senha-subtitle">Definir nova senha para o usuÃ¡rio</p>
            <form id="form-reset-senha">
                <input type="hidden" id="reset-senha-user-id">
                <input type="hidden" id="reset-senha-username">
                <div class="form-group">
                    <label for="reset-nova-senha">Nova Senha</label>
                    <input type="password" id="reset-nova-senha" required placeholder="MÃ­nimo 4 caracteres" minlength="4">
                </div>
                <div class="form-group">
                    <label for="reset-confirmar-senha">Confirmar Nova Senha</label>
                    <input type="password" id="reset-confirmar-senha" required placeholder="Repita a nova senha">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-icon-text" onclick="hideResetPassword()">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-save"></i> Redefinir
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <span class="logo">ðŸ¥š</span>
            <h2>EggVault</h2>
        </div>

        <ul class="nav-links">
            <li class="active" data-tab="estoque">
                <i class="fas fa-warehouse"></i>
                <span>Estoque</span>
            </li>
            <li data-tab="entradas">
                <i class="fas fa-arrow-circle-down"></i>
                <span>Entradas</span>
            </li>
            <li data-tab="vendas">
                <i class="fas fa-shopping-cart"></i>
                <span>Vendas</span>
            </li>
            <li data-tab="quebrados">
                <i class="fas fa-heart-crack"></i>
                <span>Quebrados</span>
            </li>
            <li data-tab="consumo" id="nav-consumo" style="display:none;">
                <i class="fas fa-utensils"></i>
                <span>Consumo</span>
            </li>
            <li data-tab="despesas">
                <i class="fas fa-file-invoice-dollar"></i>
                <span>Despesas</span>
            </li>
            <li data-tab="precos">
                <i class="fas fa-tags"></i>
                <span>PreÃ§os</span>
            </li>
            <li data-tab="relatorios">
                <i class="fas fa-chart-pie"></i>
                <span>RelatÃ³rios</span>
            </li>
            <li data-tab="admin" id="nav-admin" style="display:none;">
                <i class="fas fa-users-cog"></i>
                <span>Admin</span>
            </li>
        </ul>

        <div class="sidebar-user" id="sidebar-user">
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span id="sidebar-username">â€”</span>
            </div>
            <div class="user-actions">
                <button class="btn-sidebar-action" onclick="showChangePassword()" title="Alterar Senha">
                    <i class="fas fa-key"></i>
                </button>
                <button class="btn-sidebar-action btn-logout" onclick="doLogout()" title="Sair">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <div class="sidebar-footer">
            <small>Â© 2026 juniodevs</small>
        </div>
    </nav>

    <button class="mobile-menu-btn" id="mobile-menu-btn">
        <i class="fas fa-bars"></i>
    </button>

    <main class="main-content">

        <section id="tab-estoque" class="tab-content active">
            <div class="page-header">
                <h1><i class="fas fa-warehouse"></i> Estoque</h1>
                <p class="subtitle">VisÃ£o geral do estoque de ovos</p>
            </div>

            <div class="stock-display">
                <div class="stock-card" id="stock-main-card">
                    <div class="stock-icon">ðŸ¥š</div>
                    <div class="stock-info">
                        <span class="stock-label">Estoque Atual</span>
                        <span class="stock-value" id="stock-quantity">...</span>
                        <span class="stock-unit">unidades</span>
                    </div>
                    <div class="stock-indicator" id="stock-indicator">
                        <span class="indicator-text">Carregando...</span>
                    </div>
                </div>
            </div>

            <div class="stats-grid" id="stats-grid-estoque">
                <div class="stat-card">
                    <i class="fas fa-arrow-circle-down stat-icon entrada"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-entradas-mes">...</span>
                        <span class="stat-label">Entradas este mÃªs</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-shopping-cart stat-icon saida"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-saidas-mes">...</span>
                        <span class="stat-label">SaÃ­das este mÃªs</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-heart-crack stat-icon quebrado"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-quebrados-mes">...</span>
                        <span class="stat-label">Quebrados este mÃªs</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-dollar-sign stat-icon faturamento"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-faturamento-mes">...</span>
                        <span class="stat-label">Faturamento este mÃªs</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-file-invoice-dollar stat-icon despesa"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-despesas-mes">...</span>
                        <span class="stat-label">Despesas este mÃªs</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-tag stat-icon preco"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-preco-atual">...</span>
                        <span class="stat-label">PreÃ§o atual / ovo</span>
                    </div>
                </div>
            </div>

            <div class="last-update" id="last-update">
                Ãšltima atualizaÃ§Ã£o: â€”
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: ENTRADAS â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-entradas" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-arrow-circle-down"></i> Entrada de Ovos</h1>
                <p class="subtitle">Registre a entrada de novos ovos no estoque</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-plus-circle"></i> Nova Entrada</h3>
                    <form id="form-entrada">
                        <div class="form-group">
                            <label for="entrada-quantidade">Quantidade de Ovos</label>
                            <input type="number" id="entrada-quantidade" min="1" step="1" required placeholder="Ex: 30">
                        </div>
                        <div class="form-group">
                            <label for="entrada-observacao">ObservaÃ§Ã£o (opcional)</label>
                            <textarea id="entrada-observacao" rows="3" placeholder="Ex: Coleta da manhÃ£..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-check"></i> Registrar Entrada
                        </button>
                    </form>
                </div>

                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-calendar-day"></i> Entradas de Hoje</h3>
                        <div class="day-total" id="entradas-hoje-total">0 ovos</div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Quantidade</th>
                                    <th>ObservaÃ§Ã£o</th>
                                    <th>UsuÃ¡rio</th>
                                    <th>AÃ§Ã£o</th>
                                </tr>
                            </thead>
                            <tbody id="entradas-hoje-list">
                                <tr><td colspan="5" class="empty-state">Nenhuma entrada registrada hoje</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-history"></i> Entradas Anteriores do MÃªs</h3>
                        <div class="month-filter">
                            <button class="btn btn-icon" onclick="changeMonth('entradas', -1)"><i class="fas fa-chevron-left"></i></button>
                            <span id="entradas-month-label" class="month-label">â€”</span>
                            <button class="btn btn-icon" onclick="changeMonth('entradas', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div id="entradas-anteriores-container">
                        <div class="empty-state" style="padding: 2rem;">Nenhuma entrada anterior neste mÃªs</div>
                    </div>
                    <div class="month-total-card">
                        <span>Total do MÃªs:</span>
                        <strong id="entradas-mes-total">0 ovos</strong>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-vendas" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-shopping-cart"></i> Vendas / SaÃ­das</h1>
                <p class="subtitle">Registre a venda ou saÃ­da de ovos</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-cash-register"></i> Nova Venda</h3>
                    <div class="stock-info-bar" id="venda-stock-info">
                        <i class="fas fa-warehouse"></i>
                        Estoque disponÃ­vel: <strong id="venda-stock-qty">0</strong> ovos
                    </div>
                    <form id="form-venda">
                        <div class="form-group">
                            <label for="venda-quantidade">Quantidade</label>
                            <input type="number" id="venda-quantidade" min="1" step="1" required placeholder="Ex: 12">
                        </div>
                        <div class="form-group">
                            <label for="venda-preco">PreÃ§o UnitÃ¡rio (R$)</label>
                            <input type="text" id="venda-preco" required placeholder="0,90" inputmode="decimal">
                        </div>
                        <div class="form-group">
                            <label for="venda-total">Valor Total (R$)</label>
                            <input type="text" id="venda-total" class="total-input" required placeholder="0,00" inputmode="decimal">
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-check"></i> Registrar Venda
                        </button>
                    </form>
                </div>

                <!-- Vendas de Hoje -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-calendar-day"></i> Vendas de Hoje</h3>
                        <div class="day-total" id="vendas-hoje-total">R$ 0,00</div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Qtd</th>
                                    <th>PreÃ§o Unit.</th>
                                    <th>Total</th>
                                    <th>UsuÃ¡rio</th>
                                    <th>AÃ§Ã£o</th>
                                </tr>
                            </thead>
                            <tbody id="vendas-hoje-list">
                                <tr><td colspan="6" class="empty-state">Nenhuma venda registrada hoje</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Vendas dos Dias Anteriores -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-history"></i> Vendas Anteriores do MÃªs</h3>
                        <div class="month-filter">
                            <button class="btn btn-icon" onclick="changeMonth('vendas', -1)"><i class="fas fa-chevron-left"></i></button>
                            <span id="vendas-month-label" class="month-label">â€”</span>
                            <button class="btn btn-icon" onclick="changeMonth('vendas', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div id="vendas-anteriores-container">
                        <div class="empty-state" style="padding: 2rem;">Nenhuma venda anterior neste mÃªs</div>
                    </div>
                    <div class="month-total-card">
                        <span>Total do MÃªs:</span>
                        <strong id="vendas-mes-total">R$ 0,00</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: QUEBRADOS â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-quebrados" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-heart-crack"></i> Ovos Quebrados</h1>
                <p class="subtitle">Registre perdas de ovos quebrados</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-plus-circle"></i> Registrar Perda</h3>
                    <div class="stock-info-bar stock-info-bar-danger" id="quebrado-stock-info">
                        <i class="fas fa-warehouse"></i>
                        Estoque disponÃ­vel: <strong id="quebrado-stock-qty">0</strong> ovos
                    </div>
                    <form id="form-quebrado">
                        <div class="form-group">
                            <label for="quebrado-quantidade">Quantidade Quebrada</label>
                            <input type="number" id="quebrado-quantidade" min="1" step="1" required placeholder="Ex: 5">
                        </div>
                        <div class="form-group">
                            <label for="quebrado-motivo">Motivo (opcional)</label>
                            <textarea id="quebrado-motivo" rows="3" placeholder="Ex: CaÃ­ram durante o transporte..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-heart-crack"></i> Registrar Quebra
                        </button>
                    </form>
                </div>

                <!-- Quebrados de Hoje -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-calendar-day"></i> Quebrados de Hoje</h3>
                        <div class="day-total" id="quebrados-hoje-total" style="background: linear-gradient(135deg, #fef2f2, #fee2e2); color: #dc2626;">0 ovos</div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Quantidade</th>
                                    <th>Motivo</th>
                                    <th>UsuÃ¡rio</th>
                                    <th>AÃ§Ã£o</th>
                                </tr>
                            </thead>
                            <tbody id="quebrados-hoje-list">
                                <tr><td colspan="5" class="empty-state">Nenhum registro de quebra hoje</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Quebrados dos Dias Anteriores -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-history"></i> Quebrados Anteriores do MÃªs</h3>
                        <div class="month-filter">
                            <button class="btn btn-icon" onclick="changeMonth('quebrados', -1)"><i class="fas fa-chevron-left"></i></button>
                            <span id="quebrados-month-label" class="month-label">â€”</span>
                            <button class="btn btn-icon" onclick="changeMonth('quebrados', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div id="quebrados-anteriores-container">
                        <div class="empty-state" style="padding: 2rem;">Nenhum registro anterior neste mÃªs</div>
                    </div>
                    <div class="month-total-card" style="background: linear-gradient(135deg, #fef2f2, #fee2e2);">
                        <span>Total do MÃªs:</span>
                        <strong id="quebrados-mes-total" style="color: #dc2626;">0 ovos</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: CONSUMO PESSOAL â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-consumo" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-utensils"></i> Consumo Pessoal</h1>
                <p class="subtitle">Registre o consumo pessoal de ovos</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-plus-circle"></i> Registrar Consumo</h3>
                    <div class="stock-info-bar stock-info-bar-warning" id="consumo-stock-info">
                        <i class="fas fa-warehouse"></i>
                        Estoque disponÃ­vel: <strong id="consumo-stock-qty">0</strong> ovos
                    </div>
                    <form id="form-consumo">
                        <div class="form-group">
                            <label for="consumo-quantidade">Quantidade Consumida</label>
                            <input type="number" id="consumo-quantidade" min="1" step="1" required placeholder="Ex: 3">
                        </div>
                        <div class="form-group">
                            <label for="consumo-observacao">ObservaÃ§Ã£o (opcional)</label>
                            <textarea id="consumo-observacao" rows="3" placeholder="Ex: CafÃ© da manhÃ£..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-utensils"></i> Registrar Consumo
                        </button>
                    </form>
                </div>

                <!-- Consumo de Hoje -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-calendar-day"></i> Consumo de Hoje</h3>
                        <div class="day-total" id="consumo-hoje-total" style="background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706;">0 ovos</div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Quantidade</th>
                                    <th>ObservaÃ§Ã£o</th>
                                    <th>UsuÃ¡rio</th>
                                    <th>AÃ§Ã£o</th>
                                </tr>
                            </thead>
                            <tbody id="consumo-hoje-list">
                                <tr><td colspan="5" class="empty-state">Nenhum registro de consumo hoje</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Consumo dos Dias Anteriores -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-history"></i> Consumo Anterior do MÃªs</h3>
                        <div class="month-filter">
                            <button class="btn btn-icon" onclick="changeMonth('consumo', -1)"><i class="fas fa-chevron-left"></i></button>
                            <span id="consumo-month-label" class="month-label">â€”</span>
                            <button class="btn btn-icon" onclick="changeMonth('consumo', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div id="consumo-anteriores-container">
                        <div class="empty-state" style="padding: 2rem;">Nenhum registro anterior neste mÃªs</div>
                    </div>
                    <div class="month-total-card" style="background: linear-gradient(135deg, #fef3c7, #fde68a);">
                        <span>Total do MÃªs:</span>
                        <strong id="consumo-mes-total" style="color: #d97706;">0 ovos</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: DESPESAS â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-despesas" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-file-invoice-dollar"></i> Despesas</h1>
                <p class="subtitle">Registre despesas para subtrair do faturamento</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-plus-circle"></i> Nova Despesa</h3>
                    <form id="form-despesa">
                        <div class="form-group">
                            <label for="despesa-valor">Valor (R$)</label>
                            <input type="number" id="despesa-valor" step="0.01" min="0.01" required placeholder="Ex: 150.00">
                        </div>
                        <div class="form-group">
                            <label for="despesa-descricao">DescriÃ§Ã£o</label>
                            <textarea id="despesa-descricao" rows="3" required placeholder="Ex: Compra de raÃ§Ã£o, manutenÃ§Ã£o..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-file-invoice-dollar"></i> Registrar Despesa
                        </button>
                    </form>
                </div>

                <!-- Despesas de Hoje -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-calendar-day"></i> Despesas de Hoje</h3>
                        <div class="day-total" id="despesas-hoje-total" style="background: linear-gradient(135deg, #fff7ed, #fed7aa); color: #c2410c;">R$ 0,00</div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Valor</th>
                                    <th>DescriÃ§Ã£o</th>
                                    <th>UsuÃ¡rio</th>
                                    <th>AÃ§Ã£o</th>
                                </tr>
                            </thead>
                            <tbody id="despesas-hoje-list">
                                <tr><td colspan="5" class="empty-state">Nenhuma despesa registrada hoje</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Despesas dos Dias Anteriores -->
                <div class="card list-card">
                    <div class="card-header-row">
                        <h3><i class="fas fa-history"></i> Despesas Anteriores do MÃªs</h3>
                        <div class="month-filter">
                            <button class="btn btn-icon" onclick="changeMonth('despesas', -1)"><i class="fas fa-chevron-left"></i></button>
                            <span id="despesas-month-label" class="month-label">â€”</span>
                            <button class="btn btn-icon" onclick="changeMonth('despesas', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div id="despesas-anteriores-container">
                        <div class="empty-state" style="padding: 2rem;">Nenhuma despesa anterior neste mÃªs</div>
                    </div>
                    <div class="month-total-card" style="background: linear-gradient(135deg, #fff7ed, #fed7aa);">
                        <span>Total do MÃªs:</span>
                        <strong id="despesas-mes-total" style="color: #c2410c;">R$ 0,00</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: PREÃ‡OS â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-precos" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-tags"></i> PreÃ§os</h1>
                <p class="subtitle">Gerencie o preÃ§o unitÃ¡rio dos ovos</p>
            </div>

            <div class="content-grid">
                <div class="card form-card">
                    <h3><i class="fas fa-edit"></i> Definir PreÃ§o</h3>
                    <div class="current-price-display">
                        <span class="price-label">PreÃ§o Atual</span>
                        <span class="price-value" id="current-price">...</span>
                    </div>
                    <form id="form-preco">
                        <div class="form-group">
                            <label for="novo-preco">Novo PreÃ§o UnitÃ¡rio (R$)</label>
                            <input type="number" id="novo-preco" step="0.01" min="0" required placeholder="0,00">
                        </div>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-save"></i> Atualizar PreÃ§o
                        </button>
                    </form>
                </div>

                <div class="card list-card">
                    <h3><i class="fas fa-history"></i> HistÃ³rico de PreÃ§os</h3>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>PreÃ§o UnitÃ¡rio</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="precos-list">
                                <tr><td colspan="3" class="empty-state">Nenhum preÃ§o definido</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: RELATÃ“RIOS â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-relatorios" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-chart-pie"></i> RelatÃ³rios &amp; GrÃ¡ficos</h1>
                <p class="subtitle">AnÃ¡lise detalhada de produÃ§Ã£o e vendas</p>
            </div>

            <div class="report-filters">
                <div class="filter-group">
                    <label for="report-month">MÃªs</label>
                    <select id="report-month"></select>
                </div>
                <div class="filter-group">
                    <label for="report-year">Ano</label>
                    <select id="report-year"></select>
                </div>
                <button class="btn btn-primary" onclick="loadReport()">
                    <i class="fas fa-search"></i> Gerar RelatÃ³rio
                </button>
                <div class="export-buttons">
                    <button class="btn btn-export btn-export-excel" onclick="exportExcel()" title="Baixar Excel do mÃªs">
                        <i class="fas fa-file-excel"></i> <span class="export-label">Excel</span>
                    </button>
                    <button class="btn btn-export btn-export-pdf" onclick="exportPDF()" title="Baixar PDF do mÃªs">
                        <i class="fas fa-file-pdf"></i> <span class="export-label">PDF</span>
                    </button>
                    <button class="btn btn-export btn-export-anual" onclick="exportExcelAnual()" title="Baixar Excel anual">
                        <i class="fas fa-calendar-alt"></i> <span class="export-label">Anual</span>
                    </button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-arrow-circle-down stat-icon entrada"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-entradas">...</span>
                        <span class="stat-label">Total Entradas</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-shopping-cart stat-icon saida"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-saidas">...</span>
                        <span class="stat-label">Total Vendido</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-heart-crack stat-icon quebrado"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-quebrados">...</span>
                        <span class="stat-label">Total Quebrados</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-dollar-sign stat-icon faturamento"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-faturamento">...</span>
                        <span class="stat-label">Total Faturado</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-file-invoice-dollar stat-icon despesa"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-despesas">...</span>
                        <span class="stat-label">Total Despesas</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-coins stat-icon lucro"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-lucro">...</span>
                        <span class="stat-label">Lucro LÃ­quido</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-balance-scale stat-icon preco"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="report-saldo">...</span>
                        <span class="stat-label">Saldo do MÃªs (ovos)</span>
                    </div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="card chart-card">
                    <h3><i class="fas fa-chart-bar"></i> Entradas vs SaÃ­das</h3>
                    <div class="chart-container">
                        <canvas id="chart-entradas-saidas"></canvas>
                    </div>
                </div>
                <div class="card chart-card">
                    <h3><i class="fas fa-chart-line"></i> Faturamento Mensal</h3>
                    <div class="chart-container">
                        <canvas id="chart-faturamento"></canvas>
                    </div>
                </div>
                <div class="card chart-card chart-card-small">
                    <h3><i class="fas fa-chart-pie"></i> DistribuiÃ§Ã£o do Ano</h3>
                    <div class="chart-container chart-container-pie">
                        <canvas id="chart-distribuicao"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- â•â•â•â•â•â•â•â•â•â• ABA: ADMIN â•â•â•â•â•â•â•â•â•â• -->
        <section id="tab-admin" class="tab-content">
            <div class="page-header">
                <h1><i class="fas fa-users-cog"></i> Painel de AdministraÃ§Ã£o</h1>
                <p class="subtitle">Gerencie usuÃ¡rios e configuraÃ§Ãµes da fazenda</p>
            </div>

            <div class="content-grid">

                <!-- â”€â”€ ConfiguraÃ§Ãµes Gerais â”€â”€ -->
                <div class="card form-card admin-config-card">
                    <h3><i class="fas fa-globe"></i> ConfiguraÃ§Ãµes Gerais</h3>
                    <form id="form-config-gerais">
                        <div class="form-group">
                            <label for="config-nome-fazenda"><i class="fas fa-home"></i> Nome da Fazenda</label>
                            <input type="text" id="config-nome-fazenda" maxlength="50" placeholder="Ex: Fazenda Boa Vista">
                            <small class="form-hint">Exibido no cabeÃ§alho do sistema</small>
                        </div>
                        <div class="form-group">
                            <label for="config-timezone"><i class="fas fa-clock"></i> Fuso HorÃ¡rio</label>
                            <select id="config-timezone">
                                <optgroup label="Brasil">
                                    <option value="America/Sao_Paulo">SÃ£o Paulo (BRT, UTCâˆ’3)</option>
                                    <option value="America/Fortaleza">Fortaleza (BRT, UTCâˆ’3)</option>
                                    <option value="America/Recife">Recife (BRT, UTCâˆ’3)</option>
                                    <option value="America/Bahia">Bahia (BRT, UTCâˆ’3)</option>
                                    <option value="America/Belem">BelÃ©m (BRT, UTCâˆ’3)</option>
                                    <option value="America/Manaus">Manaus (AMT, UTCâˆ’4)</option>
                                    <option value="America/Cuiaba">CuiabÃ¡ (AMT, UTCâˆ’4)</option>
                                    <option value="America/Campo_Grande">Campo Grande (AMT, UTCâˆ’4)</option>
                                    <option value="America/Porto_Velho">Porto Velho (AMT, UTCâˆ’4)</option>
                                    <option value="America/Boa_Vista">Boa Vista (AMT, UTCâˆ’4)</option>
                                    <option value="America/Rio_Branco">Rio Branco (ACT, UTCâˆ’5)</option>
                                    <option value="America/Noronha">Fernando de Noronha (FNT, UTCâˆ’2)</option>
                                </optgroup>
                                <optgroup label="AmÃ©ricas">
                                    <option value="America/New_York">Nova York (EST, UTCâˆ’5)</option>
                                    <option value="America/Chicago">Chicago (CST, UTCâˆ’6)</option>
                                    <option value="America/Denver">Denver (MST, UTCâˆ’7)</option>
                                    <option value="America/Los_Angeles">Los Angeles (PST, UTCâˆ’8)</option>
                                </optgroup>
                                <optgroup label="Europa">
                                    <option value="Europe/London">Londres (GMT, UTC+0)</option>
                                    <option value="Europe/Lisbon">Lisboa (WET, UTC+0)</option>
                                    <option value="Europe/Madrid">Madrid (CET, UTC+1)</option>
                                    <option value="Europe/Paris">Paris (CET, UTC+1)</option>
                                </optgroup>
                                <optgroup label="Outros">
                                    <option value="Asia/Tokyo">TÃ³quio (JST, UTC+9)</option>
                                    <option value="UTC">UTC</option>
                                </optgroup>
                            </select>
                            <small class="form-hint">Afeta horÃ¡rios exibidos nos registros</small>
                        </div>
                        <div class="form-group">
                            <label for="config-moeda"><i class="fas fa-coins"></i> Moeda</label>
                            <select id="config-moeda">
                                <option value="BRL">R$ â€” Real Brasileiro (BRL)</option>
                                <option value="USD">$ â€” DÃ³lar Americano (USD)</option>
                                <option value="EUR">â‚¬ â€” Euro (EUR)</option>
                                <option value="GBP">Â£ â€” Libra Esterlina (GBP)</option>
                                <option value="ARS">$ â€” Peso Argentino (ARS)</option>
                                <option value="CLP">$ â€” Peso Chileno (CLP)</option>
                                <option value="COP">$ â€” Peso Colombiano (COP)</option>
                                <option value="MXN">$ â€” Peso Mexicano (MXN)</option>
                                <option value="PEN">S/ â€” Sol Peruano (PEN)</option>
                                <option value="UYU">$ â€” Peso Uruguaio (UYU)</option>
                                <option value="JPY">Â¥ â€” Iene JaponÃªs (JPY)</option>
                            </select>
                            <small class="form-hint">Moeda utilizada nos valores financeiros</small>
                        </div>
                        <div class="form-group">
                            <label for="config-formato-data"><i class="fas fa-calendar-alt"></i> Formato de Data</label>
                            <select id="config-formato-data">
                                <option value="DD/MM/AAAA">DD/MM/AAAA (08/02/2026)</option>
                                <option value="MM/DD/AAAA">MM/DD/AAAA (02/08/2026)</option>
                                <option value="AAAA-MM-DD">AAAA-MM-DD (2026-02-08)</option>
                            </select>
                            <small class="form-hint">Formato de exibiÃ§Ã£o das datas no sistema</small>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Salvar ConfiguraÃ§Ãµes Gerais
                        </button>
                    </form>
                </div>

                <!-- â”€â”€ ConfiguraÃ§Ãµes de MÃ³dulos â”€â”€ -->
                <div class="card form-card">
                    <h3><i class="fas fa-cog"></i> ConfiguraÃ§Ãµes de MÃ³dulos</h3>
                    <form id="form-configuracoes">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="config-consumo-habilitado">
                                <span>Habilitar Aba de Consumo Pessoal</span>
                            </label>
                            <small class="form-hint">Quando ativada, permite registrar consumo pessoal de ovos que serÃ£o subtraÃ­dos do estoque</small>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Salvar MÃ³dulos
                        </button>
                    </form>
                </div>

                <div class="card form-card">
                    <h3><i class="fas fa-user-plus"></i> Criar Nova Conta</h3>
                    <form id="form-criar-usuario">
                        <div class="form-group">
                            <label for="new-user-nome">Nome Completo</label>
                            <input type="text" id="new-user-nome" required placeholder="Ex: JoÃ£o da Silva" minlength="2">
                        </div>
                        <div class="form-group">
                            <label for="new-user-username">Login (UsuÃ¡rio)</label>
                            <input type="text" id="new-user-username" required placeholder="Ex: joao" minlength="3" autocapitalize="none">
                        </div>
                        <div class="form-group">
                            <label for="new-user-password">Senha</label>
                            <input type="password" id="new-user-password" required placeholder="MÃ­nimo 4 caracteres" minlength="4">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="new-user-admin">
                                <span>Administrador</span>
                            </label>
                            <small class="form-hint">Admins podem criar/remover contas</small>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> Criar Conta
                        </button>
                    </form>
                </div>

                <div class="card list-card">
                    <h3><i class="fas fa-users"></i> UsuÃ¡rios da Fazenda</h3>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Login</th>
                                    <th>Tipo</th>
                                    <th>Ãšltimo Acesso</th>
                                    <th>AÃ§Ãµes</th>
                                </tr>
                            </thead>
                            <tbody id="admin-users-list">
                                <tr><td colspan="5" class="empty-state">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- â•â•â•â•â•â•â•â•â•â•â• TOAST CONTAINER â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="toast-container"></div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
